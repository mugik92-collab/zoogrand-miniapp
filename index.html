<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZooGrand73 — Ульяновск</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <style>
        body { margin:0; font-family:system-ui; background:#f8f9fa; color:#2d2d2d; min-height:100vh; }
        header { background:linear-gradient(135deg,#ff9800,#e67e22); color:white; text-align:center; padding:1rem; font-size:1.4rem; font-weight:700; }
        .container { padding:1rem; padding-bottom:140px; }

        .banner-container { position:relative; height:260px; margin-bottom:1rem; overflow:hidden; border-radius:0 0 20px 20px; box-shadow:0 6px 20px #0002; }
        .main-banner { width:100%; height:100%; object-fit:cover; }

        .category-grid { display:flex; justify-content:center; gap:1rem; flex-wrap:wrap; margin:1.5rem 0; }
        .category-card { background:white; border-radius:16px; padding:1.2rem 1.6rem; text-align:center; box-shadow:0 4px 16px #0002; cursor:pointer; min-width:110px; transition:all 0.25s; }
        .category-card:hover { transform:translateY(-6px) scale(1.04); box-shadow:0 12px 32px #0003; }
        .category-card i { font-size:2.6rem; margin-bottom:0.6rem; color:#ff9800; }

        .subcategory-grid { display:grid; grid-template-columns:1fr; gap:1.2rem; }
        .subcategory-card { background:white; border-radius:16px; overflow:hidden; box-shadow:0 4px 16px #0002; cursor:pointer; transition:all 0.3s; display:flex; flex-direction:column; }
        .subcategory-card:hover { transform:translateY(-6px); box-shadow:0 12px 32px #0004; }
        .subcategory-img { width:100%; height:180px; object-fit:cover; background:#eee; flex-shrink:0; }
        .subcategory-content { padding:1rem; flex-grow:1; display:flex; flex-direction:column; justify-content:space-between; }
        .price { color:#ff9800; font-weight:700; font-size:1.3rem; margin-top:auto; }

        .back-btn, .add-btn { padding:0.8rem 1.4rem; border:none; border-radius:12px; font-weight:600; cursor:pointer; }
        .back-btn { background:#e0e0e0; color:#333; }
        .add-btn { background:#4caf50; color:white; width:100%; }

        #cart-bar { position:fixed; bottom:0; left:0; right:0; background:white; box-shadow:0 -4px 16px #0002; padding:0.8rem 1rem; display:flex; justify-content:space-between; align-items:center; z-index:100; }
        #cartList { margin:1rem 0; padding-bottom:5rem; }

        #orderModal { position:fixed; inset:0; background:rgba(0,0,0,0.6); display:flex; align-items:center; justify-content:center; z-index:200; }
        .modal-content { background:white; border-radius:16px; padding:1.8rem; width:90%; max-width:420px; box-shadow:0 10px 30px #0004; }

        .hidden { display:none !important; }
    </style>
</head>
<body>

<header>ZooGrand73 — Ульяновск</header>

<div class="container">

    <div id="mainScreen">
        <div class="banner-container">
            <img class="main-banner" 
                 src="https://picsum.photos/800/320?random=1" 
                 alt="Счастливые питомцы">
            <div style="position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); text-align:center; color:white; text-shadow:0 3px 10px #0008; z-index:2;">
                <div style="font-size:2.2rem; font-weight:900;">СЧАСТЛИВЫЕ ПИТОМЦЫ</div>
                <div style="font-size:1.5rem; color:#ffe066;">– СЧАСТЛИВАЯ СЕМЬЯ!</div>
            </div>
        </div>

        <div class="category-grid">
            <div class="category-card" onclick="showCategory('Лежанки')"><i class="fas fa-bed"></i><div>Лежанки</div></div>
            <div class="category-card" onclick="showCategory('Передержка')"><i class="fas fa-paw"></i><div>Передержка</div></div>
            <div class="category-card" onclick="showCategory('Вкусняшки')"><i class="fas fa-bone"></i><div>Вкусняшки</div></div>
        </div>
    </div>

    <div id="categoryScreen" class="hidden">
        <button class="back-btn" onclick="backToMain()">← Назад</button>
        <h2 id="categoryTitle"></h2>

        <div id="subcategoryGrid" class="subcategory-grid"></div>

        <div id="cartList"></div>
    </div>

</div>

<div id="cart-bar" class="hidden">
    <div>Корзина: <strong id="cartCount">0</strong> • <strong id="cartTotal">0 ₽</strong></div>
    <div>
        <button id="clearCartBtn">Очистить</button>
        <button id="orderBtn">Оформить</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready(); tg.expand();

    // Минимальный набор данных (без внешних картинок — используем placeholder)
    const categories = {
        "Лежанки": [
            {sub:"Лежанка-овал Эконом", price:800},
            {sub:"Лежанка-пончик Классик", price:1200},
            {sub:"Лежанка Ортопед", price:1400},
            {sub:"Лежанка-дивана Премиум", price:1500},
            {sub:"Лежанка-матрас Гигант", price:1600}
        ],
        "Передержка": [
            {sub:"Мини / Той", price:650},
            {sub:"Маленькие", price:900},
            {sub:"Маленькие-средние", price:1100},
            {sub:"Средние", price:1300},
            {sub:"Крупные", price:1900},
            {sub:"Очень крупные / Гиганты", price:3500}
        ],
        "Вкусняшки": [
            {sub:"Легкое говяжье 100 г", price:100},
            {sub:"Рубец говяжий 100 г", price:100},
            {sub:"Вымя говяжье", price:110},
            {sub:"Трахея говяжья", price:130},
            {sub:"Бычьи семенники", price:150},
            {sub:"Бычий корень", price:230},
            {sub:"Говяжьи почки", price:100}
        ]
    };

    let cart = [];

    function showCategory(cat) {
        console.log("Открываем категорию:", cat); // для отладки
        document.getElementById('mainScreen').classList.add('hidden');
        document.getElementById('categoryScreen').classList.remove('hidden');
        document.getElementById('categoryTitle').textContent = cat;

        const grid = document.getElementById('subcategoryGrid');
        grid.innerHTML = ''; // очищаем

        const items = categories[cat] || [];
        if (items.length === 0) {
            grid.innerHTML = '<p style="text-align:center;color:#999;">Нет товаров в этой категории</p>';
            return;
        }

        items.forEach(item => {
            const card = document.createElement('div');
            card.className = 'subcategory-card';
            card.innerHTML = `
                <img src="https://placehold.co/400x180?text=${encodeURIComponent(item.sub)}" style="width:100%;height:180px;object-fit:cover;background:#eee;">
                <div class="subcategory-content">
                    <h3>${item.sub}</h3>
                    <div class="price">${item.price} ₽</div>
                </div>
            `;
            card.onclick = () => alert(`Выбрано: ${item.sub} за ${item.price} ₽`);
            grid.appendChild(card);
        });

        updateCart();
    }

    function backToMain() {
        document.getElementById('categoryScreen').classList.add('hidden');
        document.getElementById('mainScreen').classList.remove('hidden');
    }

    function updateCart() {
        const count = cart.reduce((s, e) => s + (e.quantity || 0), 0);
        const total = cart.reduce((s, e) => s + (e.quantity || 0) * (e.price || 0), 0);
        document.getElementById('cartCount').textContent = count;
        document.getElementById('cartTotal').textContent = total.toFixed(0) + ' ₽';
        document.getElementById('cart-bar').classList.toggle('hidden', count === 0);
    }

    updateCart();
</script>
</body>
</html>
